\documentclass[12pt]{article}

% fonts

\usepackage[T1]{fontenc}
\usepackage[full]{textcomp}
\usepackage{newtxtext}
\usepackage{cabin} % sans serif
\usepackage[varqu,varl]{inconsolata} % sans serif typewriter
\usepackage[final,expansion=alltext]{microtype}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage[bigdelims,vvarbb]{newtxmath} % bb from STIX
\usepackage[cal=boondoxo]{mathalfa} % mathcal
\usepackage{csquotes}
\usepackage{graphicx}
\usepackage{hyperref}

\usepackage[backend=bibtex,style=numeric]{biblatex}
\bibliography{traffic} % Specify your BibTeX file

% geometry of the page

\usepackage[top=1in,
            bottom=1in,
            left=1in,
            right=1in]{geometry}


% paragraph spacing

\setlength{\parindent}{0pt}
\setlength{\parskip}{2ex plus 0.4ex minus 0.2ex}


\author{Matthew McAnear}
\title{Traffic Fatality Risk by Advanced Safety Features}

% useful packages

\begin{document}

\maketitle

\begin{abstract}
    Despite the proliferation of AI technology in passenger cars of collision detection/avoidance, lane drift systems, and
    various other safety systems, pedestrian and cyclist deaths are NOT significantly reduced by these
    interventions.
\end{abstract}


\section{Introduction}

The National Highway Traffic Safety Administration (NHTSA) reports that, as of preliminary reports through
June of 2023, traffic accidents involving fatalities, in aggregate, are down about 3\%. This decrease is positive,
but looking only at changes from year to year hides the true scale of the problem for vulnerable non-vehicle
road users. While the overall change for pedestrians is also 3\%, the baseline level of risk for pedestrians is
much higher than for passenger vehicles or even for pedalcyclists. Among accidents involving pedestrians, the fatality
range anywhere from a 14\% to 23\% baseline fatality rate throughout the year, depending on the month in
question \cite{national_highway_traffic_safety_administration_early_2024}.

This fatality rate is influenced heavily by the mass of the car\cite{evans_car_1992}. This means that there
are offsetting effects of both increasing vehicle mass and increasing
vehicle saftey. For people outside of the vehicle, however, the statistics are alarming. According to Tyndall,
"between 2010 and 2021 the number of pedestrians killed annually in collisions increased by 72\%, from 4300 to
7400 \cite{tyndall_effect_2024}." Due to relaxed emissions standards for small trucks compared to passenger cars,
American buyer preferences shifted toward sport utility vehicles (SUVs) and trucks \cite{kovach_rise_2021}. Taken into
account this connection between both the proliferation of large vehicles and the clear connection in fatality risk to
more massive and taller vehicles\cite{tyndall_effect_2024}, finding the factors that minimize pedestrian fatalities
is of critical importance for public health.

It is common knowledge that AI systems have become an increasing part of every day life, and passenger
vehicles are no exception. The question is if these improved safety systems are reducing the risk of fatalities
among pedestrians and cyclists. Next, assuming these new systems yield tangible improvements to pedestrian safety,
are the improvements large enough in magnitude to offset the increased risk from the size and height of vehicles?

In this paper, we focus primarily on those factors that influence the risk of fatalities in crashes involving pedestrians
and cyclists. After controlling for the effect of weather conditions,
geographic region, and crash variables such as time of day and intersection type, we estimate the effect
of advanged safety features on the risk of pedestrian and cyclist fatalities within vehicle types.


\section{Data}

Our data comes from the US National Highway Traffic Safety Administration (NHTSA). The NHTSA collects and distributes
crash statistics on fatal accidents through FARS, the Fatal Accident Reporting System, and CRSS, the Crash Report
Sampling System. Through these two datasets, we can investigate risk factors for fatal accidents and injuries in
pedestrian and cyclist accidents. All files are available at
[the NHTSA website](https://www.nhtsa.gov/file-downloads?p=nhtsa/downloads/). Several simplifying assumptions must be
made in order to combine the two datasets - for example, the CRSS data is taken from 60 sampling locations, not
nationwide, and weights are applied in order to estimate national level
statistics\cite{national_highway_traffic_safety_administration_crash_nodate}.  To simplify the analysis, we exclude
from consideration crashes involving multiple vehicles and focus solely on single-vehicle collisions with pedestrians
and cyclists. We also further ignore the crash group, i.e. whether the driver or cyclist was at fault, what
specific maneuver was being performed, or where the pedestrian happened to be in relation to the vehicle. These are
important characteristics to consider, but the overall sparsity of the data makes inference in small subgroups
challenging.

% The result of this subsampling is that certain information is not available at the same level of default as the 
% fatality statistics. Namely, states in the fatal crash statistics have to be manually categorized into the 
% same regions reported the CRSS. Beyond this, the names of the columns are slightly different, but the overall 
% structure of the data is otherwise analogous. The dataset is fairly complex, spanning multiple files that cover the 
% accidents, vehicles involved, specific information about the vehicles, and a host of other components. To simplify
% the analysis, we exclude from consideration crashes involving multiple vehicles and focus solely on single-vehicle 
% collisions with pedestrians and cyclists. 

Another potential issue with the dataset is the overall level of sparsity in our features. While there is no
missingness for important crash level statistics such as the bodyclass of the vehicle, things like the weight class
are missing and cannot be reliably imputed. Safety features are also missing for a large number of vehicles; to solve
this, we assume that any safety feature not listed as "standard" is not present. Though we could simulate this data
conditional on other factors, this is an extension to a future analysis and out of scope for this short paper.

\section{Methodology}

Our model will be a relatively traditional logistic regression, as we are primarily interested in inference on the
effects of our variables of interest and so need a model that retains interpretability. However, we will
add hierarchical structure to account both the full and group-level effects of each covariate across
cyclists and pedstrians. See Figure \ref{fig:model_graph} for a graphical representation of the model.

We wish to estimate the effects of the variables separately for both pedestrians and cyclists, but because of our
relatively sparse feature space, there is some concern of wild coefficient values, so for that reason we use the
hierarchical model to constrain an overall effect of a feature, and then estimate whether that effect differs
between cyclists and pedestrians. The overall effects considered are vehicle bodyclass, lighting conditions, weather
conditions, and vehicle safety features. Each beta coefficient is assumed to follow a Normal prior. We re-use the 
variability nuisance parameter for multiple levels of the hierarchy, but this simplified model fitting and prevented
divergences in the sampling process.

With so much feature sparsity, we also introduce latent discrete variables for whether to include a particular
variable in a regression. Our posterior estimates of these variables will give us a sense of which features
are worth including in the regression, as well as their final effect on the outcome. This allows us to mimic the 
Bayesian Model averaging functionality of the \texttt{BMA}\cite{raftery_bma_2022} using our model specification in 
Numpyro\cite{phan_composable_2019}. This model averaging approach sounds similar in theory to using Laplace priors 
as specified by Tibshirani in \cite{tibshirani_regression_1996}, but in practice after trying both 
methods, the two results are quite different. We will opt to use the model averaging approach, as this allows to 
better handle sparsity and yields a more parsimonious model. Our prior predictive check (Figure \ref{fig:ppc}) 
shows that this model is not overly specific and can capture the range of outcomes we are interested in. 

\section{Results}

The overall fatality rate in accidents varies distinctly by region and vulnerable road user
type (pedestrian or cyclist). As shown in \ref{fig:prob_intercepts}, the overall fatality rate
among cyclists, irrespective of region, is only about 1\%, holding all other things constant. Surpsingly,
there is a clear relationship between the fatality rate and the region, with pedestrians in the West, Midwest, and South
subject to significantly higher fatality rates in accidents when compared to the Northeast. This may likely
be due to an overall lower incidence of vehicles in the Northeast, more options for transportation away from roadways
in major urban areas, and lower speeds in highly congested cities that are not present in other regions to the
same degree.

Many of the results are exactly as one would expect, and partially align with our hypothesis. For example, the
coefficient on pickup trucks is strong positive for both cyclists and for pedestrians, indicating that these vehicles
are much more likely to kill a pedestrian or cyclist compared to cars (the baseline group). See
Figure \ref{fig:coefficients}. Many results border on the obvious - the log-odds of a fatality increase the most when
a truck/semi are involved. The trend genereally holds that increase vehicle weight corresponds to an increasing
likelihood of fatality for pedestrians and cyclists. Somewhat surprising is how these effects are manifested across
vulnerable road users. For example, pickups and semis are much more likely to kill a cyclist than a pedestrian. This is
most likely due to the nature of when and where cycling accidents take place, presumably at higher speeds on shared
infrastructure. Unfortunately, the data is missing an estimated speed in roughly 58\% of pedestrian accidents, and so
use of this as a control variable may unfairly bias our results without a more thoughtful imputation scheme.

Outside of the vehicle centric effects, the largest effects is by far if the accident takes place at night, shown in
figures \ref{fig:coefficients} and \ref{fig:all_users}. This effect is roughly the same for pedestrians and cyclists. 
Inclement weather appears to have a negative effect, such that
worse weather actually reduces the log odds of a fatality. This could be due to drivers being more cautious in
inclement weather, and also because we have collapsed a large variety of weather conditions into a single variable.

However, controlling for these factors, it appears that our safety features have relatively small or unclear effects on
the log-odds of a fatality. A marginal effect for pedestrian auto braking may be present for pedestrians, but it pales 
in comparison to the overall magnitude of effect of vehicle size and lighting conditions.
The clearest effect is the lane-departure warning system, which appears to reduce the
log-odds of a fatality substantially among cyclists. Equally substantially, however, is the effect of lane-keeping
assistance features, which appears to \textit{increase} the log-odds of a fatality among cyclists. 

To make sure of these counterintuitive result, we should remember that the sparsity and high-proportion of missingness
in our data inherently means that certain characteristics may suffer from multicollinearity that improperly
assigns weight to the wrong group. Though we have attempted to mitigate this with the 
model averaging approach, it is still possible that multicollinearity is biasing our results. We also see evidence
for this in the inclusion probabilities of our features, as shown in Figure \ref{fig:inclusion_probs}. While
several features have high inclusion probabilities that make practical sense, the exclusion of SUVs but the 
inclusion of pickups, despite their similarity, is cause for concern.


In terms of our posterior predictive checks, we can notice immediately that our overall fatality
rate that is being estimated by our model is lower than than what is reported
as of the preliminary results for 2024 by the NHTSA. The most likely explanation is that the dataset, as we've subsetted
it, has systematically lower fatality rates than the overall dataset. The exclusion of accidents
with multiple vehicles may be the culprit, as it is reasonable to suppose these accidents to involve
multiple vehicles because they are higher speed and more dangerous. The distribution of our probabilities follows
a multimodal shape, and this is to be expected given the sharp differences across regions
and pedestrian types (see Figure \ref{fig:prob_dist}).


\section{Conclusion}

We have shown that the overall fatality rate for pedestrians and cyclists in single-vehicle car 
crashes can be explained by several factors, many of which align with our initial hypotehsis and 
some that do not. The involvement of a pickup truck and poor lighting conditions are important factors 
when predicting whether a particular accident may be fatal for folks outside the car, but SUVs have no practical
significant as estimated by the model, and crossover vehicles actually decrease the probability of a fatal accident
as compared to cars. 

However, once controlling for these factors, we find that the overall impact
of advanced safety features is marginal at best, and evidence for their effectiveness
can be contradictory. As hypotehsized, region, vehicle size, and conditions plays a much 
larger role than the presence of safety features, and this research shows no unambiguous 
evidence that adding these features to large vehicles such as pickups and work vehicles 
will reduce the fatality for vulnerable road users in any practical sense.

\section{Support}

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{images/prior_predictive_check.png}
    \caption{Prior predictive check for the model. We are getting a multimoddal distribution, but we 
    also have a relatively complicated model. We are predicting probabilities on the entire
    range from 0 to 1, so we can be reasonably confident that our model is as flexible as required.}
    \label{fig:ppc}
\end{figure}

\begin{figure}[h]
\centering
    \includegraphics[width=\textwidth]{images/prob_intercepts.png}
    \caption{Forest plot of each group-level intercept. The intercepts are fit on log-odds,
    but converted to probabilities for this plot.}
    \label{fig:prob_intercepts}
\end{figure}



\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{images/model_graph.png}
    \caption{Graphical representation of the hierarchical logistic regression model.}
    \label{fig:model_graph}
\end{figure}


\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{images/traceplot.png}
    \caption{Traceplot for all variables of interest. Note that there are no divergences and good mixing across all
        chains, indicating that the model has converged across all levels of the hierarchy without major issues.}
    \label{fig:traceplot}
\end{figure}



\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{images/all_users_coefficients.png}
    \caption{Parent-level feature coefficients for variables of interest.}
    \label{fig:all_users}
\end{figure}


\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{images/feature_coefficients.png}
    \caption{Feature coefficients for all variables of interest. The coefficients represent the change in the log-odds,
        and error bars represent the 95\% HDI interval.}
    \label{fig:coefficients}
\end{figure}


\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{images/inclusion_probs.png}
    \caption{Probability of inclusion in the linear model for a particular coefficient.}
    \label{fig:inclusion_probs}
\end{figure}


\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{images/prob_dist.png}
    \caption{Distribution of estimated proabilities of fatalities for all crashes in our dataset.}
    \label{fig:prob_dist}
\end{figure}



\clearpage

\printbibliography

\end{document}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
